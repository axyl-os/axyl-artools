#!/bin/bash
#
# Copyright (C) 2018-19 artoo@artixlinux.org
# Copyright (C) 2018 Artix Linux Developers
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.

. ${LIBDIR}/artools/util-base.sh

load_base_config "${USER_CONF_DIR}" || load_base_config "${SYSCONFDIR}"

for pkglib in ${LIBDIR}/pkg/*.sh; do
    . $pkglib
done

load_pkg_config(){

    local conf="$1/artools-pkg.conf"

    [[ -f "$conf" ]] || return 1

    [[ -r "$conf" ]] && . "$conf"

    DOMAIN='artixlinux.org'

    GIT_DOMAIN="gitea.${DOMAIN}"

    GIT_URL="https://${GIT_DOMAIN}"

    GIT_TOKEN=${GIT_TOKEN:-''}

    TREE_DIR_ARTIX=${TREE_DIR_ARTIX:-"${WORKSPACE_DIR}/artixlinux"}

    [[ -z ${TREE_NAMES_ARTIX[@]} ]] && \
    TREE_NAMES_ARTIX=(
            packages
            community
            packages-kernel
            packages-openrc
            packages-runit
            packages-xorg
            packages-python
            packages-perl
            packages-java
            packages-qt5
            packages-devel
            packages-ruby
            packages-gtk
            packages-gnome
            packages-cinnamon
            packages-lxqt
            packages-mate
            packages-kde
            packages-xfce
#             packages-haskell
    )

    HOST_TREE_ARTIX=${HOST_TREE_ARTIX:-"gitea@${GIT_DOMAIN}:artixlinux"}

    TREE_DIR_ARCH=${TREE_DIR_ARCH:-"${WORKSPACE_DIR}/archlinux"}

    TREE_NAMES_ARCH=(packages community)

    HOST_TREE_ARCH=${HOST_TREE_ARCH:-'git://git.archlinux.org/svntogit'}

    CHROOTS_PKG="${CHROOTS_DIR}/buildpkg"

    REPOS_ROOT=${REPOS_ROOT:-"${WORKSPACE_DIR}/repos"}

    REPOS_MIRROR=${REPOS_MIRROR:-'http://mirror1.artixlinux.org/repos'}

    DBEXT=${DBEXT:-'xz'}

    LINKSDBEXT=${LINKSDBEXT:-"links.tar.${DBEXT}"}

    PKGDBEXT=${PKGDBEXT:-"db.tar.${DBEXT}"}

    return 0
}
